<div class="eqLogic-widget eqLogic allowResize"
	 style="height: #height#;width: #width#;border:#border#;border-radius:#border-radius#;background-color: #background-color#;color: #color#;#style#"
	 data-eqLogic_id="#id#" data-eqLogic_uid="#uid#" data-version="#version#" >
	<center class="widget-name">
		<span class="pull-left" style="color:rgb(254, 254, 254); line-height: 22.72px;">
			<span class="pull-left sun" title="jour"><i class="far fa-sun"></i></span>
			<span class="pull-left moon" title="Nuit"><i class="far fa-moon"></i></span>
			<span id="sunrise" data-type="info" data-subtype="numeric" data-cmd_id="#sunrise_id#"></span>-<span id="sunset" data-type="info" data-subtype="numeric" data-cmd_id="#sunset_id#"></span>
		</span>
		<a href="#eqLink#" style="#hideEqLogicName#">#name_display#</a>
		<span class="cmd cmd-widget refresh pull-right cursor" data-type="action" data-cmd_id="#refresh_id#"><i class="fas fa-sync"></i></span>
	</center>
		<div class="col-xs-6">
			<div id="sunAlt#id#" class="cmd" data-type="info" data-subtype="numeric" data-cmd_id="#altitude_id#" style="width: 100%; height: 100%;"></div>
		</div>
		<div class="col-xs-6">
			<div id="azimuth#id#" class="cmd" data-type="info" data-subtype="numeric" data-cmd_id="#azimuth360_id#" style="width: 100%; height: 100%;"></div>
		</div>
	<script>


		var chartAltitude_#altitude_id# = new Highcharts.Chart({
			chart: {
				height: '100%',
				renderTo: 'sunAlt#id#',
				type: 'gauge',
				backgroundColor: 'transparent',
				plotBackgroundColor: null,
				plotBackgroundImage: null,
				plotBorderWidth: 0,
				plotShadow: false,
				spacingTop: 0,
				spacingLeft: 0,
				spacingRight: 0,
				spacingBottom: 0
			},
			title: {
				text: null
			},
			credits: {
				enabled: false
			},
			pane: {
				startAngle: -180,
				endAngle: 0,
				background: null
			},
			exporting : {
				enabled: false
			},
			plotOptions: {
				series: {
					dataLabels: {
						enabled: true
					}
				},
				gauge: {
					dial: {
						backgroundColor: 'red',
						borderColor: 'red'
					},
					pivot: {
						backgroundColor: 'silver'
					}
				}
			},
			yAxis: {
				min: -90,
				max: 90,
				tickWidth: 2,
				tickLength: 10,
				tickInterval: 90,
				lineWidth: 4,
				labels: {
					distance: -16,
					formatter: function () {
						if (this.value === 0) {
							return '<span style="font-weight:bold;">0</span>';
						} else if (this.value === 45) {
							return '<span style="font-weight:bold;"></span>';
						} else if (this.value === 90) {
							return '<span style="font-weight:bold;">90</span>';
						} else if (this.value === -45) {
							return '<span style="font-weight:bold;"></span>';
						} else if (this.value === -90) {
							return '<span style="font-weight:bold;">-90</span>';
						}
					}
				},
				title: {
					text: null
				}
			},
			series: [{
				name: 'Altidude',
				data: [0],
				dial: {
					radius: '80%',
					baseWidth: 2,
					rearLength: '20%'
				},
				tooltip: {
					valueSuffix: ' °'
				},
				dataLabels: {
					formatter: function () {
						return '<span style="color:#339">' + this.y + '  °</span>';
					},
					backgroundColor: {
						linearGradient: {
							x1: 0,
							y1: 0,
							x2: 0,
							y2: 1
						},
						stops: [
							[0, '#DDD'],
							[1, '#FFF']
						]
					}
				}
			}]
		}
		);

		var chartAzimuth360_#azimuth360_id# = new Highcharts.Chart({
			chart: {
				height: '100%',
				renderTo: 'azimuth#id#',
				type: 'gauge',
				backgroundColor: 'transparent',
				plotBackgroundColor: null,
				plotBackgroundImage: null,
				plotBorderWidth: 0,
				plotShadow: false,
				spacingTop: 0,
				spacingLeft: 0,
				spacingRight: 0,
				spacingBottom: 0
			},
			title: {
				text: null
			},
			credits: {
				enabled: false
			},
			pane: {
				startAngle: 0,
				endAngle: 360,
				background: null
			},
			exporting : {
				enabled: false
			},
			plotOptions: {
				series: {
					dataLabels: {
						enabled: true
					}
				},
				gauge: {
					dial: {
						backgroundColor: 'red',
						borderColor: 'red'
					},
					pivot: {
						backgroundColor: 'silver'
					}
				}
			},
			yAxis: {
				min: 0,
				max: 360,
				tickWidth: 2,
				tickLength: 10,
				tickInterval: 45,
				lineWidth: 4,
				plotBands: [
					{
						from: 0,
						to: 10,
						color: '#DF5353' // red
					},
					{
						from: 350,
						to: 360,
						color: '#DF5353' // red
					}
				],
				labels: {
					distance: -16,
					formatter: function () {
						if (this.value === 360) {
							return '<span style="font-weight:bold;color:#DF5353 !important;">N</span>';
						} else if (this.value === 90) {
							return '<span style="font-weight:bold;color:black !important;">E</span>';
						} else if (this.value === 180) {
							return '<span style="font-weight:bold;color:black !important;">S</span>';
						} else if (this.value === 270) {
							return '<span style="font-weight:bold;color:black !important;">W</span>';
						}
					}
				},
				title: {
					text: null
				}
			},
			series: [{
				name: 'Degré',
				data: [0],
				dial: {
					radius: '80%',
					baseWidth: 2,
					rearLength: '20%'
				},
				tooltip: {
					valueSuffix: ' °'
				},
				dataLabels: {
					formatter: function () {
						return '<span style="color:#339">' + this.y + '  °</span>';
					},
					backgroundColor: {
						linearGradient: {
							x1: 0,
							y1: 0,
							x2: 0,
							y2: 1
						},
						stops: [
							[0, '#DDD'],
							[1, '#FFF']
						]
					}
				},
			}]
			
		});

		jeedom.cmd.update['#azimuth360_id#'] = function(_options){
			if (_options.display_value !== '' && _options.display_value !== undefined) {
				chartAzimuth360_#azimuth360_id#.series[0].points[0].update(_options.display_value);
			}
		};
		jeedom.cmd.update['#azimuth360_id#']({display_value:#azimuth360#});

		jeedom.cmd.update['#altitude_id#'] = function(_options){
			if (_options.display_value !== '' && _options.display_value !== undefined) {
				chartAltitude_#altitude_id#.series[0].points[0].update(_options.display_value);
				var uid = $('.eqLogic[data-eqLogic_uid=#uid#]');
				if(_options.display_value > 0) {
					uid.find('.sun').css('display', 'block');
					uid.find('.moon').css('display', 'none');
				} else {
					uid.find('.sun').css('display', 'none');
					uid.find('.moon').css('display', 'block');
				}
			}
		};
		jeedom.cmd.update['#altitude_id#']({display_value:#altitude#});

		jeedom.cmd.update['#sunrise_id#'] = function(_options){
			if (_options.display_value !== '' && _options.display_value !== undefined) {
				var uid = $('.eqLogic[data-eqLogic_uid=#uid#]');
				var value = _options.display_value.padStart(4, 0);
				uid.find('#sunrise').empty().append(value.substr(0, 2) + ":" + value.substr(2, 2));
			}
		};
		jeedom.cmd.update['#sunrise_id#']({display_value:"#sunrise#"});

		jeedom.cmd.update['#sunset_id#'] = function(_options){
			if (_options.display_value !== '' && _options.display_value !== undefined) {
				var uid = $('.eqLogic[data-eqLogic_uid=#uid#]');
				var value = _options.display_value.padStart(4, 0);
				uid.find('#sunset').empty().append(value.substr(0, 2) + ":" + value.substr(2, 2));
			}
		};
		jeedom.cmd.update['#sunset_id#']({display_value:"#sunset#"});

		var refresh = $('.eqLogic[data-eqLogic_uid=#uid#] .refresh');
		if ('#refresh_id#' !== '') {
			refresh.on('click', function () {
				jeedom.cmd.execute({id: '#refresh_id#'});
			});
		} else {
			refresh.remove();
		}
	</script>
</div>